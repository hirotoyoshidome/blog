<!DOCTYPE html><html lang="ja"> <head><!-- Google Tag Manager --><!-- End Google Tag Manager --><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>TLSの基礎知識</title><meta name="description" content="TLSの基礎知識に関するメモ。"><!-- OGP --><meta property="og:title" content="TLSの基礎知識"><meta name="og:description" content="TLSの基礎知識に関するメモ。"><meta property="og:type" content="website"><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="TLSの基礎知識"><meta name="twitter:description" content="TLSの基礎知識に関するメモ。"><link rel="icon" type="image/png" href="/images/favicon.ico"><link rel="stylesheet" href="/_astro/_page_.Cqs_ohrY.css"><script type="module" src="/_astro/hoisted.DBccM9AK.js"></script></head> <body class="prose prose-neutral mx-auto p-6"> <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TLLX6XR3" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!-- End Google Tag Manager (noscript) -->  <main class="max-w-3xl mx-auto px-6 py-10 text-gray-800 leading-relaxed"> <nav aria-label="Breadcrumb" class="text-sm text-gray-500 mb-6"> <ol class="flex flex-wrap items-center gap-2 list-none"> <li><a href="/" class="text-blue-600 hover:underline">ホーム</a></li> <li aria-hidden="true" class="text-gray-400">/</li> <li><a href="/ja/" class="text-blue-600 hover:underline">記事一覧</a></li> <li aria-hidden="true" class="text-gray-400">/</li> <li class="font-semibold text-gray-700 truncate max-w-[60ch]">TLSの基礎知識</li> </ol> </nav> <header class="mb-8"> <h1 class="text-4xl font-bold tracking-tight mb-2">TLSの基礎知識</h1> <div class="flex flex-wrap items-center gap-3 text-sm text-gray-600"> <time datetime="2019-01-03T00:00:00.000Z"> 2019-01-03 </time> </div> <ul class="flex flex-wrap gap-2 mt-4 list-none"> <li class="text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full font-medium">
#Security </li><li class="text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full font-medium">
#Encryption </li><li class="text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full font-medium">
#Know-how </li> </ul> <nav class="text-sm text-gray-600 flex flex-wrap gap-3 mt-4"> <a href="/en/posts/2019/memo-tls/" class="text-blue-600 hover:underline flex items-center gap-1"> <span aria-hidden="true">⇄</span> English </a> </nav> </header> <ul>
<li>2019/01/03</li>
</ul>
<h1 id="tlsの基礎知識">TLSの基礎知識</h1>
<p>2019年12月にBitBucketがTLS1.2のサポートしかしなくなったことより、業務でTLS1, 1.1を使用して接続しているサーバーに対してアップデートをかけたのでこれを忘れないために備忘録として書き残します。</p>
<p>TLSのことを知る前にまずSSLについて知っておかないといけません。</p>
<h2 id="sslとは">SSLとは</h2>
<p>Secure Socket Layerのことで安全に通信を行うためのプロトコルのことです。</p>
<p>インターネットの普及に伴い、安全な通信方法(通信の暗号化)で接続する必要性が出てきました。</p>
<p>そのためSSLは発展し、現在でも使用されている通信方式となります。</p>
<p>身近なものとしてはhttp通信のSSL化をすることでhttpsプロトコルを使用してよりセキュアな通信をすることができる様にすることができます。</p>
<h2 id="tlsとは">TLSとは</h2>
<p>TLSはTransport Layer SecurityのことでSSLを引き継いだ通信プロトコルとなります。</p>
<p>TLSではSSLのときと比べてそれまでに知りえた攻撃手法の対策によるセキュリティの強化がされているより安全なセキュリティプロトコルのことです。</p>
<h2 id="bitbucketのtls1-11のサポートが切れることはなぜ">BitBucketのTLS1, 1.1のサポートが切れることはなぜ？？</h2>
<p>ここでTLSの以前のバージョンのサポートが切れたことについて書きたいと思います。</p>
<p>ちなみにGitHubでは昨年の2月末の時点でサポートは終了しており、TLS1.2以外での通信では接続ができなくなっているようです</p>
<p>参考：<a href="https://github.com/autopkg/autopkg/issues/408">https://github.com/autopkg/autopkg/issues/408</a></p>
<p>これは以前のバージョンのプロトコルで接続を行うとセキュリティ的に良くないことが原因です。</p>
<p>以前のバージョンでは脆弱性やそれ以降のバージョンで対策のされていることについて対策が施されていない通信方式でアクセスすることとなります。</p>
<p>そのため、サーバー側でセキュリティの担保ができないためサイト側でTLSのサポートするバージョンを指定しているのです。</p>
<h2 id="自分のサイトでtlsの接続の制限をするには">自分のサイトでTLSの接続の制限をするには？？</h2>
<p>個人サイトの運営でも、上記の理由からTLSのバージョンを制限することでよりセキュアなサイト構築ができるようになると思われます。</p>
<p>が、古いバージョンでの接続をするユーザーからのアクセスができなくなってしまうため要注意です。</p>
<p>下記のサイトより参考にTLSのバージョンを制限することができるようです(Apacheの場合)</p>
<p><a href="https://weblabo.oscasierra.net/apache-httpd-sslprotocol/">https://weblabo.oscasierra.net/apache-httpd-sslprotocol/</a></p>
<h2 id="opensslでの接続を確認する方法">Opensslでの接続を確認する方法</h2>
<p>TLSのバージョンを指定して接続をする場合、opensslを使用して確認する方法とcurlを使用して確認する方法があります。</p>
<h3 id="opensslの場合">Opensslの場合</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>openssl s_client -connect SSL化をしているドメイン:443 -tls1_2</span></span>
<span class="line"><span></span></span></code></pre>
<p>上記のコマンドで確認することができます(Linux環境)</p>
<p>上記のコマンドを実行して <code>Cipher</code> の値が0000以外のものが取得できていれば正常に接続できていることとなります。</p>
<p>上記のtlsのバージョンを指定している部分を1_1とかに変更してGitHubのドメインにアクセスすると接続が拒否されることが確認できると思います。(1_2では接続できます)</p>
<h3 id="curlの場合">Curlの場合</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>curl -s -v --tlsv1.2 https://SSL化をしているドメイン > /dev/null</span></span>
<span class="line"><span></span></span></code></pre>
<p>上記のコマンドで確認することができます。</p>
<p>こちらもTLSのバージョンを指定している部分を変更することで正常に値が取得できるかを確認することができると思います。</p>
<h3 id="opensslのバージョンをあげることで対応をする">OpenSSLのバージョンをあげることで対応をする</h3>
<p>古いサーバーを使用している場合、デフォルトのopensslのバージョンではTLSのバージョンを指定してコマンドを確認することができないものがあります。</p>
<p>私が実施してみた感じCentOSの5系では古くて使用できませんでした。</p>
<p>その場合はopensslのバージョンを上げてTLSのバージョンを指定して確認することができるようになります。</p>
<p>下記を参考にしてopensslのバージョンを更新してみてください！！</p>
<p><a href="https://k-sugi.sakura.ne.jp/it_synthesis/linux/4370/">https://k-sugi.sakura.ne.jp/it_synthesis/linux/4370/</a></p>
<h2 id="最後に">最後に</h2>
<p>今回はTLSについて簡単にまとめてみました。</p>
<p>普段、インフラ側をやっていない方はTLSとは何ぞやって感じの方が多いと思いますが知っておいて損のないことですのでこの機会に自分で軽く調べてみるのもいいかもしれませんね。</p>
<h3 id="参考">参考</h3>
<ul>
<li><a href="https://ssl.sakura.ad.jp/column/ssl_tls/">https://ssl.sakura.ad.jp/column/ssl_tls/</a></li>
</ul> <section class="mt-10 border-t pt-6 space-y-8"> <div class="flex flex-wrap gap-3 items-center"> <span class="text-sm text-gray-600">Share:</span> <a class="text-sm px-3 py-1.5 rounded border hover:bg-gray-50" href="https://twitter.com/intent/tweet?text=TLS%E3%81%AE%E5%9F%BA%E7%A4%8E%E7%9F%A5%E8%AD%98&url=https%3A%2F%2Fhirotoyoshidome.com%2Fja%2Fposts%2F2019%2Fmemo_tls%2F" rel="noopener">
X (Twitter)
</a> </div> </section> </main>  </body></html>