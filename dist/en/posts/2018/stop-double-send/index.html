<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Three Common Ways to Prevent Double Submits</title><meta name="description" content="Notes on PRG, tokens, and UI tricks to stop duplicate form submissions."><!-- OGP --><meta property="og:title" content="Three Common Ways to Prevent Double Submits"><meta name="og:description" content="Notes on PRG, tokens, and UI tricks to stop duplicate form submissions."><meta property="og:type" content="website"><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Three Common Ways to Prevent Double Submits"><meta name="twitter:description" content="Notes on PRG, tokens, and UI tricks to stop duplicate form submissions."><link rel="icon" type="image/png" href="/images/favicon.ico"><link rel="stylesheet" href="/_astro/_page_.C60xkf-5.css"></head> <body class="prose prose-neutral mx-auto p-6">  <main class="max-w-3xl mx-auto px-6 py-10 text-gray-800 leading-relaxed"> <nav aria-label="Breadcrumb" class="text-sm text-gray-500 mb-6"> <ol class="flex flex-wrap items-center gap-2 list-none"> <li><a href="/" class="text-blue-600 hover:underline">Home</a></li> <li aria-hidden="true" class="text-gray-400">/</li> <li><a href="/en/" class="text-blue-600 hover:underline">Posts</a></li> <li aria-hidden="true" class="text-gray-400">/</li> <li class="font-semibold text-gray-700 truncate max-w-[60ch]">Three Common Ways to Prevent Double Submits</li> </ol> </nav> <header class="mb-8"> <h1 class="text-4xl font-bold tracking-tight mb-2">Three Common Ways to Prevent Double Submits</h1> <div class="flex flex-wrap items-center gap-3 text-sm text-gray-600"> <time datetime="2018-09-25T00:00:00.000Z"> 2018-09-25 </time> </div> <ul class="flex flex-wrap gap-2 mt-4 list-none"> <li class="text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full font-medium">
#Security </li><li class="text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full font-medium">
#CSRF </li><li class="text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full font-medium">
#Best Practices </li><li class="text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full font-medium">
#UI/UX </li> </ul> <nav class="text-sm text-gray-600 flex flex-wrap gap-3 mt-4"> <a href="/ja/posts/2018/stop_double_send/" class="text-blue-600 hover:underline flex items-center gap-1"> <span aria-hidden="true">⇄</span> 日本語 </a> </nav> </header> <ul>
<li>2018/09/25</li>
</ul>
<h2 id="three-classic-countermeasures">Three classic countermeasures</h2>
<ul>
<li><strong>PRG pattern (Post/Redirect/Get)</strong> – When form data is posted, immediately issue a redirect and return a GET response. Even if the user double-clicks, the redirect prevents the same POST from being processed twice.</li>
<li><strong>Tokens</strong> – Include a random value (e.g., hidden input or parameter) keyed to each form submission. If the user submits twice, the server detects the duplicated token and rejects it. You need proper error handling.</li>
<li><strong>Disable the submit button with JavaScript</strong> – On the first click, disable the button so it cannot be clicked again. Because users can disable JS on the client, do not rely on this alone.</li>
</ul>
<h2 id="damage-caused-by-double-submits">Damage caused by double submits</h2>
<ul>
<li>Duplicate rows inserted into the DB</li>
<li>Data inconsistencies</li>
<li>Potential security issues if attackers exploit the behavior</li>
</ul>
<h2 id="typical-triggers">Typical triggers</h2>
<ul>
<li>Double-clicking the submit button</li>
<li>Reloading the page (F5, Cmd/Ctrl+R)</li>
<li>Going back (Alt + ←) and resubmitting</li>
<li>CSRF attacks that force the same request</li>
</ul>
<h2 id="closing">Closing</h2>
<p>These are the countermeasures I see most often.</p> <section class="mt-10 border-t pt-6 space-y-8"> <div class="flex flex-wrap gap-3 items-center"> <span class="text-sm text-gray-600">Share:</span> <a class="text-sm px-3 py-1.5 rounded border hover:bg-gray-50" href="https://twitter.com/intent/tweet?text=Three%20Common%20Ways%20to%20Prevent%20Double%20Submits&url=https%3A%2F%2Fhirotoyoshidome.com%2Fen%2Fposts%2F2018%2Fstop-double-send%2F" rel="noopener">
X (Twitter)
</a> </div> </section> </main>  </body></html>